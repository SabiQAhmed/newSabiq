package com.OptixCXM.AYS;

import java.awt.Robot;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FileInputStream;
import java.time.Duration;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import com.e2e.Utilities.ExtentReport;
import com.e2e.Utilities.PrintUtil;

import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebDriver.Timeouts;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.Test;

import com.e2e.Utilities.BaseClass;
import com.e2e.Utilities.CommonFunctions;
import com.e2e.Utilities.WebDriverInstance;
import com.e2e.Utilities.WebDriverUtility;
import com.e2e.cxm.ConstructionScheduling.Cxm_Login;
import com.e2e.vbuild.EWO.Ewo_Functions;

public class EVO_Login extends BaseClass{
	
	private static WebDriverInstance wdinstance;
	public static String ApplPropFilePath = "PropertyFiles/CXM.properties";
	public static String url = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CXM_URL");
	public static String username = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CXM_UserName");
	public static String password = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CXM_Password");
	public static String ssoUsername = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "sso_username");
	public static String ssoPassword = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "sso_pass");
	public static String ssoSignIn = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "sso_signIn");
	public static String Iagree = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "agree");
	public static String SecondToggle = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "SecondToggle");
	public static String SearchEWO = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "SearchEWO");
	public static String TechWorkCenter = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "TechWorkCenter");
	public static String Baltimore = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "Baltimore");
	public static String searchbtn = CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "searchbtn");
	public static String SearchTech= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "SearchTech");
	public static String MoreOptions= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "MoreOptions");
	public static String Cxm_LogOut= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "Cxm_LogOut");
	public static String CWA_clear= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CWA_clear");
	public static String CWA_Date= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CWA_Date");
	public static String CWA_DateToday= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CWA_DateToday");
	public static String CWA_Region= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CWA_Region");
	public static String CWA_RegionCP= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "CWA_RegionCP");
	public static String EWO_L1= CommonFunctions.getPropValuesFromFile(ApplPropFilePath, "EWO_L1");
	
	
	@Test	
	public static void CXMLogin() { 
    		try {
    			wdinstance = new WebDriverInstance();
    			driver = wdinstance.getWebDriverInstace("Chrome");
    			driver.get(url);
    			JavascriptExecutor js = (JavascriptExecutor) driver;
    			js.executeScript("document.body.style.zoom='100%'");
    			//Logging into CXM Application
    			WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(ssoUsername), 30).sendKeys(username);
    	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(ssoPassword), 30).sendKeys(password);
    	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(ssoSignIn), 30).click();
    	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(Iagree), 30).click();
    	   		
    	   		
    		//PrintUtil.logSuccess("CXM Login Successful ", logger);
    		System.out.println("********CXM logged in Successfully*********");
    	}catch(Exception e) {
    		System.out.println(e.toString());
    	}
    	}
	
	@Test
	public static void Construction_WorkAssignment() {
		try {
			Thread.sleep(2000);
			WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(SecondToggle), 30).click();
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(CWA_clear), 30).click();
	   		Thread.sleep(2000);
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(CWA_Date), 30).click();
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(CWA_DateToday), 30).click();
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(CWA_Region), 30).click();
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(CWA_RegionCP), 30).click();
			Thread.sleep(2000);
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(searchbtn), 30).click();
	
			Thread.sleep(3000);
			WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(EWO_L1), 30).click();
			Thread.sleep(3000);
			
			
			//for selecting Microsoft edge browsers
			Robot robot =new Robot();
			Thread.sleep(2000);
			robot.keyPress(KeyEvent.VK_TAB);
			robot.keyRelease(KeyEvent.VK_TAB);
			
			
			robot.keyPress(KeyEvent.VK_TAB);
			robot.keyRelease(KeyEvent.VK_TAB);
			
			
			robot.keyPress(KeyEvent.VK_ENTER);
			robot.keyRelease(KeyEvent.VK_ENTER);
			
			//i want to control in edge browser
	
			WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(ssoUsername), 30).sendKeys(username);
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(ssoPassword), 30).sendKeys(password);
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(ssoSignIn), 30).click();
	   		WebDriverUtility.waitForVisibilityOfElementLocated(driver, wait, By.xpath(Iagree), 30).click();
		
		}
		catch(Exception e) {
			System.out.println(e.toString());
		}
	}
}
